RewriteEngine on
RewriteBase /

ErrorDocument 404 /index.php?art_title=not_found

#  www to non-www url syntax
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 

#safe site, js and css, tiny_mce
RewriteRule (css|sites|js|tiny_mce|img|xsl)/(.+) $1/$2

RewriteRule ^feed/rss$ controller.php?obj=feeds_ctrl&method=rss2
RewriteRule ^feed/atom$ controller.php?obj=feeds_ctrl&method=atom

#OAI
RewriteRule ^OAI$ controller.php?obj=OAI_ctrl&method=run [QSA]
RewriteRule ^oai$ controller.php?obj=OAI_ctrl&method=run [QSA]


#admin 
RewriteRule ^admin/?$ admin.php
RewriteRule ^admin:debug?$ admin.php?debug=1
RewriteRule ^admin:mini?$ admin.php?mini=1

#safe home page 
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/?$ index.php?lang=$1 

#tags
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/([a-zA-Z0-9-_+~]+).all$ index.php?lang=$1&tags=$2
RewriteRule ^([a-zA-Z0-9-_+~]+).all$ index.php?tags=$1


#art_title no html
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/([a-zA-Z0-9-_]+)/?$ index.php?lang=$1&art_title=$2
RewriteRule ^([a-zA-Z0-9-_]+)/?$ index.php?art_title=$1

#art_title with html extension
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/([a-zA-Z0-9-_]+).html$ index.php?lang=$1&art_title=$2
RewriteRule ^([a-zA-Z0-9-_]+).html$ index.php?art_title=$1

#art_title, draft
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/([a-zA-Z0-9-_]+).draft$ index.php?lang=$1&art_title=$2&draft=1
RewriteRule ^([a-zA-Z0-9-_]+).draft$ index.php?art_title=$1&draft=true

#search
RewriteRule ^(it|en|es|fr|ar|de|al|el|jp)/search:([a-zA-Z0-1-_\.]+)$ index.php?lang=$1&search=$2
RewriteRule ^search:([a-zA-Z0-9-_\.]+)$ index.php?search=$1

<FilesMatch "\.(htaccess|htpasswd|ini|log|inc|bak|sqlite)$">
	order allow,deny
	deny from all
</FilesMatch>